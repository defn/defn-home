#!/usr/bin/env bash

function home_update {
  local shome="${_defn_home_home:-"$(cd -P -- "${BASH_SOURCE%/*}/.." && pwd -P)"}"
  source "$shome/script/profile"

  mkdir -p "$SVDIR"

  ln -nfs "$BLOCK_PATH/limbo/sv/squid" "$SVDIR/squid"
  ln -nfs "$BLOCK_PATH/webterm/sv/webterm" "$SVDIR/webterm"
  ln -nfs "$BLOCK_PATH/jenkins/sv/jenkins" "$SVDIR/jenkins"
  ln -nfs "$BLOCK_PATH/apt-mirror/sv/apt-mirror" "$SVDIR/apt-mirror"
  ln -nfs "$BLOCK_PATH/linkerd/sv/linkerd" "$SVDIR/linkerd"
  ln -nfs "$BLOCK_PATH/consul/sv/consul" "$SVDIR/consul"
  ln -nfs "$BLOCK_PATH/sinopia/sv/sinopia" "$SVDIR/sinopia"

  case "$(uname -s)" in
    Darwin)
      if ! ifconfig -a | grep "${CACHE_VIP}"; then
        sudo ifconfig en0 alias "${CACHE_VIP}/24" up
      fi
      ;;
  esac
}

home_update "$@"
