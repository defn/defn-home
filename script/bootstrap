#!/usr/bin/env bash

function home_bootstrap {
  local shome="$(cd -P -- "${BASH_SOURCE%/*}/.." && pwd -P)"

  source "$shome/script/profile"

  local cmd_app="$(which app 2>&- || true)"
  if [[ ! -x "$cmd_app" ]]; then
    if [[ ! -d "$shome/work/app" ]]; then
      git clone git@github.com:defn/app "$shome/work/app"
      (cd "$shome/work/app" && script/bootstrap)
    fi
  fi

  "$shome/script/update"
  "$shome/script/build"
}

home_bootstrap "$@"
